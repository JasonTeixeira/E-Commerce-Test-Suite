[pytest]
minversion = 7.4

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths =
    ui_tests
    api_tests
    integration
    accessibility
    security

# Command line options
addopts =
    -ra
    --strict-markers
    --strict-config
    --showlocals
    --tb=short
    -v
    --color=yes
    --code-highlight=yes
    --maxfail=10
    --durations=10

# Markers
markers =
    smoke: Quick smoke tests for critical functionality
    regression: Full regression test suite
    critical: Critical path tests that must pass
    ui: User interface automation tests
    api: API endpoint tests
    performance: Performance and load tests
    security: Security vulnerability tests
    accessibility: Accessibility compliance tests (WCAG)
    visual: Visual regression tests
    integration: Integration and end-to-end tests
    database: Database-related tests
    contract: API contract tests
    slow: Tests that take longer to run (>5 seconds)
    flaky: Tests that may occasionally fail
    skip_ci: Tests to skip in CI environment
    browser_chromium: Tests for Chromium browser
    browser_firefox: Tests for Firefox browser
    browser_webkit: Tests for WebKit/Safari browser
    mobile: Mobile responsive tests
    tablet: Tablet viewport tests
    desktop: Desktop-only tests
    auth: Authentication-related tests
    checkout: Checkout flow tests
    cart: Shopping cart tests
    products: Product catalog tests
    search: Search functionality tests

# Logging configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = logs/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] [%(filename)s:%(lineno)d] %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Timeout configuration
timeout = 300
timeout_method = thread

# Coverage options
[coverage:run]
source = .
omit =
    */tests/*
    */test_*.py
    */__init__.py
    */venv/*
    */.venv/*
    */conftest.py
branch = true

[coverage:report]
precision = 2
show_missing = true
skip_covered = false

[coverage:html]
directory = reports/coverage
